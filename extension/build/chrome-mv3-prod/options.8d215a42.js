var e,t;"function"==typeof(e=globalThis.define)&&(t=e,e=null),function(t,n,r,o,a){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},l="function"==typeof i[o]&&i[o],s=l.cache||{},c="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function p(e,n){if(!s[e]){if(!t[e]){var r="function"==typeof i[o]&&i[o];if(!n&&r)return r(e,!0);if(l)return l(e,!0);if(c&&"string"==typeof e)return c(e);var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}E.resolve=function(n){var r=t[e][1][n];return null!=r?r:n},E.cache={};var u=s[e]=new p.Module(e);t[e][0].call(u.exports,E,u,u.exports,this)}return s[e].exports;function E(e){var t=E.resolve(e);return!1===t?{}:p(t)}}p.isParcelRequire=!0,p.Module=function(e){this.id=e,this.bundle=p,this.exports={}},p.modules=t,p.cache=s,p.parent=l,p.register=function(e,n){t[e]=[function(e,t){t.exports=n},{}]},Object.defineProperty(p,"root",{get:function(){return i[o]}}),i[o]=p;for(var u=0;u<n.length;u++)p(n[u]);if(r){var E=p(r);"object"==typeof exports&&"undefined"!=typeof module?module.exports=E:"function"==typeof e&&e.amd?e(function(){return E}):a&&(this[a]=E)}}({PmFp7:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js"),o=e("react/jsx-runtime"),a=e("react");r.interopDefault(a);var i=e("react-dom/client"),l=e("@plasmo-static-common/react"),s=e("../../src/options/index.tsx");let c=null;document.addEventListener("DOMContentLoaded",()=>{if(c)return;c=document.getElementById("__plasmo");let e=(0,i.createRoot)(c),t=(0,l.getLayout)(s);e.render((0,o.jsx)(t,{children:(0,o.jsx)(s.default,{})}))})},{"react/jsx-runtime":"react/jsx-runtime",react:"react","react-dom/client":"react-dom/client","@plasmo-static-common/react":"9COdz","../../src/options/index.tsx":"dUonE","@parcel/transformer-js/src/esmodule-helpers.js":"emD5w"}],"9COdz":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"getLayout",()=>a);var o=e("react");let a=e=>"function"==typeof e.Layout?e.Layout:"function"==typeof e.getGlobalProvider?e.getGlobalProvider():o.Fragment},{react:"react","@parcel/transformer-js/src/esmodule-helpers.js":"emD5w"}],emD5w:[function(e,t,n){n.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},n.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.exportAll=function(e,t){return Object.keys(e).forEach(function(n){"default"===n||"__esModule"===n||t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[n]}})}),t},n.export=function(e,t,n){Object.defineProperty(e,t,{enumerable:!0,get:n})}},{}],dUonE:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n);var o=e("react/jsx-runtime"),a=e("react");r.interopDefault(a);var i=e("webextension-polyfill"),l=r.interopDefault(i),s=e("../config/storageKeys"),c=e("../utils"),p=e("../constants");n.default=()=>{let[e,t]=(0,a.useState)(""),[n,r]=(0,a.useState)(p.DEFAULT_DETECTION_ENDPOINT),[i,u]=(0,a.useState)(!0),[E,d]=(0,a.useState)("api"),[m,T]=(0,a.useState)(p.LOCAL_DETECTION_ENDPOINT_DEFAULT),[f,_]=(0,a.useState)("free"),[h,A]=(0,a.useState)([]),[D,g]=(0,a.useState)(""),[O,x]=(0,a.useState)("");(0,a.useEffect)(()=>{I()},[]);let I=async()=>{let e=await (0,l.default).storage.local.get({[s.STORAGE_KEYS.API_KEY]:"",[s.STORAGE_KEYS.DETECTION_ENDPOINT]:p.DEFAULT_DETECTION_ENDPOINT,[s.STORAGE_KEYS.BADGE_ENABLED]:!0,[s.STORAGE_KEYS.DETECTION_MODE]:"api",[s.STORAGE_KEYS.LOCAL_ENDPOINT]:p.LOCAL_DETECTION_ENDPOINT_DEFAULT,[s.STORAGE_KEYS.PLAN_TIER]:"free",[s.STORAGE_KEYS.DISABLED_HOSTS]:[]});t(e[s.STORAGE_KEYS.API_KEY]??""),r("string"==typeof e[s.STORAGE_KEYS.DETECTION_ENDPOINT]&&e[(0,s.STORAGE_KEYS).DETECTION_ENDPOINT].trim().length>0?e[(0,s.STORAGE_KEYS).DETECTION_ENDPOINT].trim():p.DEFAULT_DETECTION_ENDPOINT),u(!1!==e[s.STORAGE_KEYS.BADGE_ENABLED]),d("local"===e[s.STORAGE_KEYS.DETECTION_MODE]?"local":"api"),T("string"==typeof e[s.STORAGE_KEYS.LOCAL_ENDPOINT]&&e[(0,s.STORAGE_KEYS).LOCAL_ENDPOINT].trim().length>0?e[(0,s.STORAGE_KEYS).LOCAL_ENDPOINT].trim():p.LOCAL_DETECTION_ENDPOINT_DEFAULT),_("pro"===e[s.STORAGE_KEYS.PLAN_TIER]?"pro":"free");let n=Array.isArray(e[s.STORAGE_KEYS.DISABLED_HOSTS])?e[(0,s.STORAGE_KEYS).DISABLED_HOSTS].filter(e=>"string"==typeof e):[];A(n)},S=async()=>{let t={imagionApiKey:e.trim(),imagionDetectionEndpoint:n.trim()||p.DEFAULT_DETECTION_ENDPOINT,imagionBadgeEnabled:i,imagionDisabledHosts:h,imagionDetectionMode:E,imagionLocalEndpoint:m.trim()||n.trim()||p.LOCAL_DETECTION_ENDPOINT_DEFAULT,imagionPlanTier:f};try{await (0,l.default).storage.local.set(t),x("Settings saved."),setTimeout(()=>x(""),2e3)}catch{x("Failed to save settings.")}},N=e=>{A(t=>t.filter(t=>t!==e))},L=e=>{_(e),"free"!==e&&"local"===E&&d("api")};return(0,o.jsxs)("div",{className:"options-shell",children:[(0,o.jsx)("h1",{children:"Imagion Settings"}),(0,o.jsxs)("section",{children:[(0,o.jsxs)("label",{children:["API key",(0,o.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value)})]}),(0,o.jsxs)("label",{children:["Detection endpoint",(0,o.jsx)("input",{type:"text",value:n,onChange:e=>r(e.target.value)})]}),(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"checkbox",checked:i,onChange:e=>u(e.target.checked)}),"Show badges"]})]}),(0,o.jsxs)("section",{children:[(0,o.jsx)("h2",{children:"Plan"}),(0,o.jsx)("button",{type:"button",onClick:()=>L("free"),className:"free"===f?"active":"",children:"Free"}),(0,o.jsx)("button",{type:"button",onClick:()=>L("pro"),className:"pro"===f?"active":"",children:"Pro"})]}),(0,o.jsxs)("section",{children:[(0,o.jsx)("h2",{children:"Detection mode"}),(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"radio",name:"detection-mode",value:"api",checked:"api"===E,onChange:()=>d("api")}),"API"]}),(0,o.jsxs)("label",{children:[(0,o.jsx)("input",{type:"radio",name:"detection-mode",value:"local",checked:"local"===E,onChange:()=>d("local"),disabled:"free"!==f}),"Local"]}),"local"===E&&(0,o.jsxs)("label",{children:["Local endpoint",(0,o.jsx)("input",{type:"text",value:m,onChange:e=>T(e.target.value)})]})]}),(0,o.jsxs)("section",{children:[(0,o.jsx)("h2",{children:"Disabled hosts"}),(0,o.jsxs)("div",{className:"domain-input",children:[(0,o.jsx)("input",{type:"text",value:D,onChange:e=>g(e.target.value),placeholder:"example.com"}),(0,o.jsx)("button",{type:"button",onClick:()=>{let e=(0,c.normalizeHostname)(D);if(!e||h.includes(e)){g("");return}A(t=>[...t,e]),g("")},children:"Add"})]}),(0,o.jsx)("ul",{children:h.map(e=>(0,o.jsxs)("li",{children:[e,(0,o.jsx)("button",{type:"button",onClick:()=>N(e),children:"Remove"})]},e))})]}),(0,o.jsxs)("footer",{children:[(0,o.jsx)("button",{type:"button",onClick:S,children:"Save"}),O&&(0,o.jsx)("span",{children:O})]})]})}},{"react/jsx-runtime":"react/jsx-runtime",react:"react","webextension-polyfill":"webextension-polyfill","../config/storageKeys":"641yc","../utils":"bN3p2","../constants":"1zg42","@parcel/transformer-js/src/esmodule-helpers.js":"emD5w"}],"641yc":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"STORAGE_KEYS",()=>o);let o={API_KEY:"imagionApiKey",DETECTION_ENDPOINT:"imagionDetectionEndpoint",BADGE_ENABLED:"imagionBadgeEnabled",USER_EMAIL:"imagionUserEmail",USER_TIER:"imagionUserTier",MONTHLY_DETECTIONS:"imagionMonthlyDetections",TOTAL_DETECTIONS:"imagionTotalDetections",DAILY_DETECTIONS:"imagionDailyDetections",MONTHLY_LIMIT:"imagionMonthlyLimit",DAILY_LIMIT:"imagionDailyLimit",DETECTION_MODE:"imagionDetectionMode",LOCAL_ENDPOINT:"imagionLocalEndpoint",PLAN_TIER:"imagionPlanTier",DISABLED_HOSTS:"imagionDisabledHosts",TELEMETRY:"imagionTelemetry",HASH_HISTORY:"recentImageHistory",RATE_LIMIT_STATE:"imagionRateLimitState",ONBOARDING_COMPLETE:"imagionOnboardingComplete"}},{"@parcel/transformer-js/src/esmodule-helpers.js":"emD5w"}],bN3p2:[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");function o(e,t){if(!e)return null;try{return new URL(e,t||void 0).toString()}catch{return null}}function a(e){try{let t=new URL(e),n=t.pathname.split("/").filter(Boolean),r=n[n.length-1];return r||"imagion-image.jpg"}catch{return"imagion-image.jpg"}}function i(e){let t=e.trim();if(!t)return null;try{let e=new URL(t.includes("://")?t:`https://${t}`);return e.hostname.toLowerCase()}catch{return t.toLowerCase()}}function l(e,t){let n=i(e);if(!n)return!1;let r=n.startsWith("www.")?n.slice(4):n;return t.has(n)||t.has(r)}function s(e){try{let t=new URL(e);return t.pathname.endsWith("/api/detect")?t.pathname=t.pathname.replace(/\/api\/detect$/,"/api/cache/hash"):t.pathname=`${t.pathname.replace(/\/$/,"")}/api/cache/hash`,t.toString()}catch{let t=e.replace(/\/$/,"");return`${t}/api/cache/hash`}}function c(e){try{let t=new URL(e);return t.pathname.endsWith("/api/detect")?t.pathname=t.pathname.replace("/api/detect","/api/usage/status"):t.pathname=`${t.pathname.replace(/\/$/,"")}/api/usage/status`,t.toString()}catch{let t=e.replace(/\/$/,"");return`${t}/api/usage/status`}}function p(e,t){if(!e)return t/1e3;let n=Number.parseInt(e,10);return Number.isFinite(n)&&n>0?n:t/1e3}function u(e,t){return`${t}:${e}`}function E(e){return"object"==typeof e&&null!==e&&"string"==typeof e.hash&&e.hash.length>0&&"number"==typeof e.createdAt&&"object"==typeof e.payload&&null!==e.payload&&"string"==typeof e.payload.status&&("api"===e.mode||"local"===e.mode)}function d(e){return!!e&&"object"==typeof e&&["burst","daily","plan"].includes(e.reason)&&"number"==typeof e.expiresAt&&Number.isFinite(e.expiresAt)}async function m(e){let t=await e.arrayBuffer(),n=await crypto.subtle.digest("SHA-256",t),r=Array.from(new Uint8Array(n));return r.map(e=>e.toString(16).padStart(2,"0")).join("")}function T(e){let t=document.createElement("div");return t.textContent=e,t.innerHTML}function f(e){return!e||e.length<20?e:`${e.substring(0,12)}...${e.substring(e.length-4)}`}function _(e){return null==e?"\u221e":e.toLocaleString()}r.defineInteropFlag(n),r.export(n,"normalizeImageUrl",()=>o),r.export(n,"extractFileName",()=>a),r.export(n,"normalizeHostname",()=>i),r.export(n,"isHostBlocked",()=>l),r.export(n,"getCacheLookupEndpoint",()=>s),r.export(n,"getUsageStatusEndpoint",()=>c),r.export(n,"parseRetryAfter",()=>p),r.export(n,"buildRequestKey",()=>u),r.export(n,"isHashHistoryEntry",()=>E),r.export(n,"isRateLimitIndicator",()=>d),r.export(n,"hashBlobSHA256",()=>m),r.export(n,"escapeHtml",()=>T),r.export(n,"maskApiKey",()=>f),r.export(n,"formatLimit",()=>_)},{"@parcel/transformer-js/src/esmodule-helpers.js":"emD5w"}],"1zg42":[function(e,t,n){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"DEFAULT_DETECTION_ENDPOINT",()=>o),r.export(n,"LOCAL_DETECTION_ENDPOINT_DEFAULT",()=>a),r.export(n,"DEFAULT_BASE_URL",()=>i),r.export(n,"REQUEST_TTL_MS",()=>l),r.export(n,"MAX_CONCURRENT_DETECTIONS",()=>s),r.export(n,"TELEMETRY_LIMIT",()=>c),r.export(n,"BACKOFF_MIN_MS",()=>p),r.export(n,"BACKOFF_MAX_MS",()=>u),r.export(n,"MAX_HASH_HISTORY",()=>E),r.export(n,"MAX_CACHE_SIZE",()=>d),r.export(n,"MAX_IMAGE_UPLOAD_BYTES",()=>m),r.export(n,"MIN_IMAGE_DIMENSION",()=>T),r.export(n,"MAX_TRACKED_IMAGES",()=>f),r.export(n,"SCAN_DEBOUNCE_MS",()=>_),r.export(n,"INITIAL_SCAN_DELAY_MS",()=>h),r.export(n,"RATE_LIMIT_BADGE_TEXT",()=>A),r.export(n,"RATE_LIMIT_BADGE_COLOR",()=>D),r.export(n,"EXCLUDED_DOMAINS",()=>g),r.export(n,"AI_VERDICTS",()=>O),r.export(n,"UNCERTAIN_VERDICTS",()=>x),r.export(n,"REAL_VERDICTS",()=>I),r.export(n,"HIGH_CONFIDENCE_AI_THRESHOLD",()=>S),r.export(n,"CONTEXT_MENU_ID",()=>N),r.export(n,"ALARM_CACHE_SWEEP",()=>L),r.export(n,"ALARM_KEEPALIVE",()=>y),r.export(n,"AUTH_ENDPOINT_PATH",()=>j);let o="http://localhost:3000/api/detect",a="http://localhost:4000/api/detect",i="http://localhost:3000",l=3e5,s=3,c=40,p=15e3,u=6e4,E=250,d=500,m=10485760,T=50,f=200,_=300,h=500,A="!",D="#ff4d67",g=["localhost","127.0.0.1","imagion.ai","www.imagion.ai"],O=new Set(["ai","fake","ai_generated","likely_ai"]),x=new Set(["uncertain"]),I=new Set(["real","likely_real"]),S=.85,N="imagion-analyze-image",L="imagion-cache-sweep",y="imagion-keepalive",j="/api/auth/extension"},{"@parcel/transformer-js/src/esmodule-helpers.js":"emD5w"}]},["PmFp7"],"PmFp7","parcelRequire36d2"),globalThis.define=t;