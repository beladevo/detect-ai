(function(){"use strict";const u={en:{savedMessage:"Settings saved.",savingMessage:"Saving...",addDomainLabel:"Disable badges on specific hosts",addButtonLabel:"Add",removeButtonLabel:"Remove",domainExistsMessage:"Host already blocked.",domainAddedMessage:"Host added.",domainRemovedMessage:"Host removed.",saveErrorMessage:"Unable to save settings.",domainPlaceholder:"example.com"},es:{savedMessage:"Configuración guardada.",savingMessage:"Guardando...",addDomainLabel:"Deshabilitar insignias en hosts específicos",addButtonLabel:"Agregar",removeButtonLabel:"Eliminar",domainExistsMessage:"El host ya está bloqueado.",domainAddedMessage:"Host agregado.",domainRemovedMessage:"Host eliminado.",saveErrorMessage:"No se pudieron guardar los ajustes.",domainPlaceholder:"ejemplo.com"}},r={imagionApiKey:"",imagionDetectionEndpoint:"http://localhost:3000/api/detect",imagionBadgeEnabled:!0,imagionDisabledHosts:[]},y=document.getElementById("settings-form"),p=document.getElementById("api-key"),b=document.getElementById("detection-endpoint"),E=document.getElementById("badge-enabled"),d=document.getElementById("status"),v=document.getElementById("save-button"),l=document.getElementById("domain-input"),f=document.getElementById("add-domain-btn"),m=document.getElementById("domain-list"),D=navigator.language.split("-")[0],n=u[D]??u.en;let o=[];function B(){return new Promise(t=>{chrome.storage.local.get(r,e=>{t({imagionApiKey:typeof e.imagionApiKey=="string"?e.imagionApiKey:"",imagionDetectionEndpoint:typeof e.imagionDetectionEndpoint=="string"&&e.imagionDetectionEndpoint.trim().length>0?e.imagionDetectionEndpoint.trim():r.imagionDetectionEndpoint,imagionBadgeEnabled:e.imagionBadgeEnabled!==!1,imagionDisabledHosts:Array.isArray(e.imagionDisabledHosts)?e.imagionDisabledHosts.filter(a=>typeof a=="string"):[]})})})}function L(t){return new Promise(e=>{chrome.storage.local.set(t,()=>e())})}function i(t,e=!0){d.textContent=t,d.style.color=e?"#22c55e":"#f87171"}function s(t=3e3){setTimeout(()=>{d.textContent=""},t)}function h(t){const e=t.trim();if(!e)return null;try{return(e.includes("://")?new URL(e):new URL(`https://${e}`)).hostname.toLowerCase()}catch{return e.toLowerCase()}}function c(){m.innerHTML="",o.forEach(t=>{const e=document.createElement("li");e.textContent=t;const a=document.createElement("button");a.type="button",a.className="remove-domain",a.textContent=n.removeButtonLabel,a.addEventListener("click",()=>{o=o.filter(A=>A!==t),c(),g(!1),i(n.domainRemovedMessage),s()}),e.appendChild(a),m.appendChild(e)})}async function g(t=!0){const e={imagionApiKey:p.value.trim(),imagionDetectionEndpoint:b.value.trim()||r.imagionDetectionEndpoint,imagionBadgeEnabled:E.checked,imagionDisabledHosts:o};try{return await L(e),t&&(i(n.savedMessage),s()),!0}catch{return i(n.saveErrorMessage,!1),s(),!1}}async function M(){const t=await B();p.value=t.imagionApiKey,b.value=t.imagionDetectionEndpoint,E.checked=t.imagionBadgeEnabled,o=t.imagionDisabledHosts,c(),l.placeholder=n.domainPlaceholder;const e=document.querySelector(".domain-blocker label");e&&(e.textContent=n.addDomainLabel),f.textContent=n.addButtonLabel}y.addEventListener("submit",async t=>{t.preventDefault(),v.disabled=!0,i(n.savingMessage,!0),await g(),v.disabled=!1,s()}),f.addEventListener("click",async()=>{const t=h(l.value);if(t){if(o.includes(t)){i(n.domainExistsMessage,!1),s();return}o=[...o,t],c(),await g(!1),i(n.domainAddedMessage),s(),l.value=""}}),d.setAttribute("aria-live","polite"),m.setAttribute("aria-live","polite"),M()})();
//# sourceMappingURL=options.js.map
