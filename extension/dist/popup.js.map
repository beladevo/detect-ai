{"version":3,"file":"popup.js","sources":["../src/popup.ts"],"sourcesContent":["const LOG_PREFIX = \"[Imagion Popup]\";\nconst USAGE_STATUS_MESSAGE = \"REQUEST_USAGE_STATUS\";\n\r\ntype StorageData = {\n  imagionApiKey: string;\n  imagionDetectionEndpoint: string;\n  imagionBadgeEnabled: boolean;\n  imagionUserEmail: string;\n  imagionUserTier: string;\n  imagionMonthlyDetections: number;\n  imagionTotalDetections: number;\n  imagionDailyDetections: number;\n  imagionMonthlyLimit: number | null;\n  imagionDailyLimit: number | null;\n};\n\r\ntype AuthResponse = {\n  success: boolean;\n  user?: {\n    id: string;\n    email: string;\n    name: string | null;\n    tier: string;\n    monthlyDetections: number;\n    totalDetections: number;\n  };\n  apiKey?: string;\n  error?: string;\n};\n\ntype UsageStatusPayload = {\n  tier: string;\n  dailyUsed: number;\n  monthlyUsed: number;\n  dailyLimit: number | null;\n  monthlyLimit: number | null;\n  totalDetections: number;\n  monthlyResetAt: string;\n  dailyResetAt: string;\n};\n\r\nconst DEFAULT_ENDPOINT = \"http://localhost:3000\";\r\nconst AUTH_ENDPOINT_PATH = \"/api/auth/extension\";\r\n\r\n// DOM Elements\r\nconst viewLoading = document.getElementById(\"view-loading\") as HTMLDivElement;\r\nconst viewLogin = document.getElementById(\"view-login\") as HTMLDivElement;\r\nconst viewAuthenticated = document.getElementById(\"view-authenticated\") as HTMLDivElement;\r\n\r\nconst loginForm = document.getElementById(\"login-form\") as HTMLFormElement;\r\nconst emailInput = document.getElementById(\"email\") as HTMLInputElement;\r\nconst passwordInput = document.getElementById(\"password\") as HTMLInputElement;\r\nconst loginBtn = document.getElementById(\"login-btn\") as HTMLButtonElement;\r\nconst loginStatus = document.getElementById(\"login-status\") as HTMLDivElement;\r\n\r\nconst advancedToggle = document.getElementById(\"advanced-toggle\") as HTMLSpanElement;\r\nconst advancedSection = document.getElementById(\"advanced-section\") as HTMLDivElement;\r\nconst endpointInput = document.getElementById(\"endpoint-input\") as HTMLInputElement;\r\n\r\nconst userEmail = document.getElementById(\"user-email\") as HTMLDivElement;\r\nconst userTier = document.getElementById(\"user-tier\") as HTMLDivElement;\r\nconst monthlyDetections = document.getElementById(\"monthly-detections\") as HTMLDivElement;\nconst totalDetections = document.getElementById(\"total-detections\") as HTMLDivElement;\nconst monthlyLimit = document.getElementById(\"monthly-limit\") as HTMLDivElement;\nconst dailyLimit = document.getElementById(\"daily-limit\") as HTMLDivElement;\nconst apiKeyDisplay = document.getElementById(\"api-key-display\") as HTMLDivElement;\nconst copyApiKeyBtn = document.getElementById(\"copy-api-key\") as HTMLButtonElement;\r\nconst badgeToggle = document.getElementById(\"badge-toggle\") as HTMLInputElement;\r\nconst logoutBtn = document.getElementById(\"logout-btn\") as HTMLButtonElement;\r\n\r\nconst registerLink = document.getElementById(\"register-link\") as HTMLAnchorElement;\r\nconst forgotLink = document.getElementById(\"forgot-link\") as HTMLAnchorElement;\r\nconst dashboardLink = document.getElementById(\"dashboard-link\") as HTMLAnchorElement;\r\nconst optionsLink = document.getElementById(\"options-link\") as HTMLAnchorElement;\r\n\r\nlet currentApiKey = \"\";\r\nlet baseUrl = DEFAULT_ENDPOINT;\r\n\r\nfunction showView(view: \"loading\" | \"login\" | \"authenticated\") {\r\n  viewLoading.classList.remove(\"active\");\r\n  viewLogin.classList.remove(\"active\");\r\n  viewAuthenticated.classList.remove(\"active\");\r\n\r\n  switch (view) {\r\n    case \"loading\":\r\n      viewLoading.classList.add(\"active\");\r\n      break;\r\n    case \"login\":\r\n      viewLogin.classList.add(\"active\");\r\n      break;\r\n    case \"authenticated\":\r\n      viewAuthenticated.classList.add(\"active\");\r\n      break;\r\n  }\r\n}\r\n\r\nfunction showStatus(message: string, type: \"error\" | \"success\") {\r\n  loginStatus.textContent = message;\r\n  loginStatus.className = `status show ${type}`;\r\n}\r\n\r\nfunction hideStatus() {\r\n  loginStatus.className = \"status\";\r\n}\r\n\r\nfunction setLoading(loading: boolean) {\r\n  loginBtn.disabled = loading;\r\n  loginBtn.innerHTML = loading\r\n    ? '<span class=\"spinner\"></span> Signing in...'\r\n    : \"Sign In\";\r\n}\r\n\r\nfunction maskApiKey(key: string): string {\n  if (!key || key.length < 20) return key;\n  return `${key.substring(0, 12)}...${key.substring(key.length - 4)}`;\n}\n\nfunction formatLimit(value: number | null | undefined): string {\n  if (value == null) {\n    return \"âˆž\";\n  }\n  return value.toLocaleString();\n}\n\r\nasync function getStorage(): Promise<Partial<StorageData>> {\r\n  return new Promise((resolve) => {\n    chrome.storage.local.get(\n      {\n        imagionApiKey: \"\",\n        imagionDetectionEndpoint: `${DEFAULT_ENDPOINT}/api/detect`,\n        imagionBadgeEnabled: true,\n        imagionUserEmail: \"\",\n        imagionUserTier: \"\",\n        imagionMonthlyDetections: 0,\n        imagionTotalDetections: 0,\n        imagionDailyDetections: 0,\n        imagionMonthlyLimit: null,\n        imagionDailyLimit: null,\n      },\n      (items) => resolve(items as StorageData)\n    );\n  });\n}\n\r\nasync function setStorage(data: Partial<StorageData>): Promise<void> {\r\n  return new Promise((resolve) => {\r\n    chrome.storage.local.set(data, () => resolve());\r\n  });\r\n}\r\n\r\nasync function checkAuthStatus() {\n  console.debug(LOG_PREFIX, \"Checking auth status...\");\n  const storage = await getStorage();\n\r\n  // Extract base URL from endpoint\r\n  if (storage.imagionDetectionEndpoint) {\r\n    try {\r\n      const url = new URL(storage.imagionDetectionEndpoint);\r\n      baseUrl = `${url.protocol}//${url.host}`;\r\n    } catch {\r\n      baseUrl = DEFAULT_ENDPOINT;\r\n    }\r\n  }\r\n\r\n  endpointInput.value = baseUrl;\r\n\r\n  if (storage.imagionApiKey) {\n    console.info(LOG_PREFIX, \"User is authenticated\");\n    currentApiKey = storage.imagionApiKey;\n    displayAuthenticatedView(storage);\n    showView(\"authenticated\");\n    void refreshUsageStatus();\n  } else {\n    console.info(LOG_PREFIX, \"User is not authenticated\");\n    showView(\"login\");\n  }\n}\n\nasync function refreshUsageStatus() {\n  if (!currentApiKey) {\n    return;\n  }\n\n  return new Promise<void>((resolve) => {\n    chrome.runtime.sendMessage({ type: USAGE_STATUS_MESSAGE }, async (response) => {\n      if (chrome.runtime.lastError) {\n        console.warn(LOG_PREFIX, \"Usage status unavailable:\", chrome.runtime.lastError.message);\n        resolve();\n        return;\n      }\n\n      if (!response?.success || !response?.usage) {\n        resolve();\n        return;\n      }\n\n      const usage = response.usage as UsageStatusPayload;\n      await setStorage({\n        imagionMonthlyDetections: usage.monthlyUsed,\n        imagionDailyDetections: usage.dailyUsed,\n        imagionMonthlyLimit: usage.monthlyLimit,\n        imagionDailyLimit: usage.dailyLimit,\n        imagionTotalDetections: usage.totalDetections,\n      });\n\n      const updated = await getStorage();\n      displayAuthenticatedView(updated);\n      resolve();\n    });\n  });\n}\n\r\nfunction displayAuthenticatedView(storage: Partial<StorageData>) {\n  userEmail.textContent = storage.imagionUserEmail || \"Unknown\";\n  userTier.textContent = storage.imagionUserTier || \"FREE\";\n  monthlyDetections.textContent = String(storage.imagionMonthlyDetections || 0);\n  totalDetections.textContent = String(storage.imagionTotalDetections || 0);\n  monthlyLimit.textContent = formatLimit(storage.imagionMonthlyLimit);\n  dailyLimit.textContent = formatLimit(storage.imagionDailyLimit);\n  apiKeyDisplay.textContent = maskApiKey(storage.imagionApiKey || \"\");\n  badgeToggle.checked = storage.imagionBadgeEnabled !== false;\n\r\n  // Update links with base URL\r\n  registerLink.href = `${baseUrl}/register`;\r\n  forgotLink.href = `${baseUrl}/forgot-password`;\r\n  dashboardLink.href = `${baseUrl}/dashboard`;\r\n}\r\n\r\nasync function handleLogin(e: Event) {\r\n  e.preventDefault();\r\n  hideStatus();\r\n\r\n  const email = emailInput.value.trim();\r\n  const password = passwordInput.value;\r\n  const customEndpoint = endpointInput.value.trim();\r\n\r\n  if (!email || !password) {\r\n    showStatus(\"Please enter email and password\", \"error\");\r\n    return;\r\n  }\r\n\r\n  // Update base URL if custom endpoint provided\r\n  if (customEndpoint) {\r\n    try {\r\n      const url = new URL(customEndpoint);\r\n      baseUrl = `${url.protocol}//${url.host}`;\r\n    } catch {\r\n      showStatus(\"Invalid endpoint URL\", \"error\");\r\n      return;\r\n    }\r\n  }\r\n\r\n  setLoading(true);\r\n  console.info(LOG_PREFIX, \"Attempting login for:\", email);\n\r\n  try {\r\n    const response = await fetch(`${baseUrl}${AUTH_ENDPOINT_PATH}`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ email, password }),\r\n    });\r\n\r\n    const data: AuthResponse = await response.json();\r\n    console.debug(LOG_PREFIX, \"Auth response:\", response.status, data.success);\n\r\n    if (!response.ok || !data.success) {\r\n      showStatus(data.error || \"Authentication failed\", \"error\");\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    if (!data.apiKey) {\r\n      showStatus(\"No API key received\", \"error\");\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    // Save to storage\r\n    await setStorage({\r\n      imagionApiKey: data.apiKey,\r\n      imagionDetectionEndpoint: `${baseUrl}/api/detect`,\r\n      imagionUserEmail: data.user?.email || email,\r\n      imagionUserTier: data.user?.tier || \"FREE\",\r\n      imagionMonthlyDetections: data.user?.monthlyDetections || 0,\r\n      imagionTotalDetections: data.user?.totalDetections || 0,\r\n      imagionBadgeEnabled: true,\r\n    });\r\n\r\n    currentApiKey = data.apiKey;\r\n    console.info(LOG_PREFIX, \"Login successful, API key saved\");\n\r\n    // Clear form\r\n    emailInput.value = \"\";\r\n    passwordInput.value = \"\";\r\n\r\n    // Show authenticated view\r\n    const storage = await getStorage();\n    displayAuthenticatedView(storage);\n    showView(\"authenticated\");\n    void refreshUsageStatus();\n  } catch (error) {\n    console.error(LOG_PREFIX, \"Login error:\", error);\r\n    showStatus(\r\n      error instanceof Error ? error.message : \"Network error. Check your connection.\",\r\n      \"error\"\r\n    );\r\n  } finally {\r\n    setLoading(false);\r\n  }\r\n}\r\n\r\nasync function handleLogout() {\r\n  console.info(LOG_PREFIX, \"Logging out...\");\n\r\n  await setStorage({\n    imagionApiKey: \"\",\n    imagionUserEmail: \"\",\n    imagionUserTier: \"\",\n    imagionMonthlyDetections: 0,\n    imagionTotalDetections: 0,\n    imagionDailyDetections: 0,\n    imagionMonthlyLimit: null,\n    imagionDailyLimit: null,\n  });\n\r\n  currentApiKey = \"\";\r\n  showView(\"login\");\r\n}\r\n\r\nasync function handleCopyApiKey() {\r\n  if (!currentApiKey) return;\r\n\r\n  try {\r\n    await navigator.clipboard.writeText(currentApiKey);\r\n    const originalText = copyApiKeyBtn.textContent;\r\n    copyApiKeyBtn.textContent = \"Copied!\";\r\n    setTimeout(() => {\r\n      copyApiKeyBtn.textContent = originalText;\r\n    }, 2000);\r\n  } catch (error) {\r\n    console.error(LOG_PREFIX, \"Failed to copy:\", error);\r\n  }\r\n}\r\n\r\nasync function handleBadgeToggle() {\r\n  const enabled = badgeToggle.checked;\r\n  console.debug(LOG_PREFIX, \"Badge toggle:\", enabled);\n  await setStorage({ imagionBadgeEnabled: enabled });\r\n}\r\n\r\nfunction handleAdvancedToggle() {\r\n  advancedSection.classList.toggle(\"show\");\r\n  advancedToggle.textContent = advancedSection.classList.contains(\"show\")\r\n    ? \"Hide advanced settings\"\r\n    : \"Advanced settings\";\r\n}\r\n\r\nfunction openUrl(url: string) {\r\n  chrome.tabs.create({ url });\r\n}\r\n\r\n// Event Listeners\r\nloginForm.addEventListener(\"submit\", handleLogin);\r\nlogoutBtn.addEventListener(\"click\", handleLogout);\r\ncopyApiKeyBtn.addEventListener(\"click\", handleCopyApiKey);\r\nbadgeToggle.addEventListener(\"change\", handleBadgeToggle);\r\nadvancedToggle.addEventListener(\"click\", handleAdvancedToggle);\r\n\r\nregisterLink.addEventListener(\"click\", (e) => {\r\n  e.preventDefault();\r\n  openUrl(`${baseUrl}/register`);\r\n});\r\n\r\nforgotLink.addEventListener(\"click\", (e) => {\r\n  e.preventDefault();\r\n  openUrl(`${baseUrl}/forgot-password`);\r\n});\r\n\r\ndashboardLink.addEventListener(\"click\", (e) => {\r\n  e.preventDefault();\r\n  openUrl(`${baseUrl}/dashboard`);\r\n});\r\n\r\noptionsLink.addEventListener(\"click\", (e) => {\r\n  e.preventDefault();\r\n  chrome.runtime.openOptionsPage();\r\n});\r\n\r\n// Initialize\r\nconsole.info(LOG_PREFIX, \"Popup initialized\");\ncheckAuthStatus();\r\n\r\nexport {};\r\n"],"names":["LOG_PREFIX","USAGE_STATUS_MESSAGE","DEFAULT_ENDPOINT","AUTH_ENDPOINT_PATH","viewLoading","viewLogin","viewAuthenticated","loginForm","emailInput","passwordInput","loginBtn","loginStatus","advancedToggle","advancedSection","endpointInput","userEmail","userTier","monthlyDetections","totalDetections","monthlyLimit","dailyLimit","apiKeyDisplay","copyApiKeyBtn","badgeToggle","logoutBtn","registerLink","forgotLink","dashboardLink","optionsLink","currentApiKey","baseUrl","showView","view","showStatus","message","type","hideStatus","setLoading","loading","maskApiKey","key","formatLimit","value","getStorage","resolve","items","setStorage","data","checkAuthStatus","storage","url","displayAuthenticatedView","refreshUsageStatus","response","usage","updated","handleLogin","e","email","password","customEndpoint","error","handleLogout","handleCopyApiKey","originalText","handleBadgeToggle","enabled","handleAdvancedToggle","openUrl"],"mappings":"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"}