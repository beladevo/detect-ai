{"version":3,"file":"content.js","sources":["../src/content.ts"],"sourcesContent":["const STYLE_ID = \"imagion-badge-style\";\r\nconst MAX_TRACKED_IMAGES = 200;\r\nconst trackedImages = new Map<HTMLImageElement, { badge: HTMLDivElement }>();\r\nlet badgeCounter = 0;\r\nlet positionScheduled = false;\r\nlet scanScheduled = false;\r\nconst state = {\r\n  enabled: true,\r\n};\r\n\r\ntype BadgeResponse = {\r\n  status?: \"success\" | \"missing-key\" | \"error\" | \"rate-limit\";\r\n  verdict?: string;\r\n  score?: number;\r\n  confidence?: number;\r\n  presentation?: string;\r\n  message?: string;\r\n  badgeId: string;\r\n  imageUrl?: string;\r\n  retryAfterSeconds?: number;\r\n};\r\n\r\ntype ContentLocaleStrings = {\r\n  aiLabel: string;\r\n  realLabel: string;\r\n  errorLabel: string;\r\n  loginLabel: string;\r\n  badgePrefix: string;\r\n  tooltipFallback: string;\r\n  rateLimitLabel: string;\r\n  disabledHostMessage: string;\r\n};\r\n\r\nconst TRANSLATIONS: Record<string, ContentLocaleStrings> = {\r\n  en: {\r\n    aiLabel: \"AI\",\r\n    realLabel: \"Real\",\r\n    errorLabel: \"Error\",\r\n    loginLabel: \"Log in\",\r\n    badgePrefix: \"Imagion badge\",\r\n    tooltipFallback: \"Imagion verdict\",\r\n    rateLimitLabel: \"Rate limited\",\r\n    disabledHostMessage: \"Badges paused on this host.\",\r\n  },\r\n  es: {\r\n    aiLabel: \"IA\",\r\n    realLabel: \"Real\",\r\n    errorLabel: \"Error\",\r\n    loginLabel: \"Iniciar sesión\",\r\n    badgePrefix: \"Insignia Imagion\",\r\n    tooltipFallback: \"Veredicto de Imagion\",\r\n    rateLimitLabel: \"Límite de velocidad\",\r\n    disabledHostMessage: \"Insignias pausadas en este host.\",\r\n  },\r\n};\r\n\r\nconst localeCode = navigator.language.split(\"-\")[0];\r\nconst localized = TRANSLATIONS[localeCode] ?? TRANSLATIONS.en;\r\n\r\nconst badgeStyle = `\r\n.imagion-badge {\r\n  position: absolute;\r\n  pointer-events: none;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 4px;\r\n  padding: 2px 6px;\r\n  font-size: 10px;\r\n  font-weight: 600;\r\n  border-radius: 999px;\r\n  background: rgba(44, 120, 255, 0.85);\r\n  color: #fff;\r\n  box-shadow: 0 0 6px rgba(0, 0, 0, 0.35);\r\n  z-index: 2147483647;\r\n  letter-spacing: 0.02em;\r\n  font-family: \"Inter\", \"Segoe UI\", system-ui, sans-serif;\r\n  text-transform: uppercase;\r\n}\r\n.imagion-badge__logo {\r\n  width: 14px;\r\n  height: 14px;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border-radius: 50%;\r\n  background: #fff;\r\n  color: #1c1c1c;\r\n  font-size: 9px;\r\n}\r\n.imagion-badge__label {\r\n  line-height: 1;\r\n}\r\n.imagion-badge--ai {\r\n  background: rgba(124, 77, 255, 0.95);\r\n}\r\n.imagion-badge--real {\r\n  background: rgba(0, 200, 138, 0.95);\r\n}\r\n.imagion-badge--error {\r\n  background: rgba(255, 69, 96, 0.95);\r\n}\r\n.imagion-badge--missing-key {\r\n  background: rgba(255, 195, 0, 0.95);\r\n  color: #2b2b2b;\r\n}\r\n`;\r\n\r\nfunction insertBadgeStyles() {\r\n  if (document.getElementById(STYLE_ID)) {\r\n    return;\r\n  }\r\n  const style = document.createElement(\"style\");\r\n  style.id = STYLE_ID;\r\n  style.textContent = badgeStyle;\r\n  document.head.appendChild(style);\r\n}\r\n\r\nfunction schedulePositionUpdate() {\r\n  if (positionScheduled) {\r\n    return;\r\n  }\r\n  positionScheduled = true;\r\n  requestAnimationFrame(() => {\r\n    positionScheduled = false;\r\n    updateAllBadgePositions();\r\n  });\r\n}\r\n\r\nfunction scheduleScan() {\r\n  if (scanScheduled) {\r\n    return;\r\n  }\r\n  scanScheduled = true;\r\n  requestAnimationFrame(() => {\r\n    scanScheduled = false;\r\n    scanForImages();\r\n  });\r\n}\r\n\r\nfunction updateAllBadgePositions() {\r\n  for (const [img, meta] of trackedImages) {\r\n    if (!img.isConnected) {\r\n      meta.badge.remove();\r\n      trackedImages.delete(img);\r\n      continue;\r\n    }\r\n    updateBadgePosition(img, meta.badge);\r\n  }\r\n}\r\n\r\nfunction shouldSkipScanning() {\r\n  return !state.enabled || isHostBlocked(window.location.hostname);\r\n}\r\n\r\nfunction scanForImages() {\r\n  if (shouldSkipScanning()) {\r\n    removeAllBadges();\r\n    return;\r\n  }\r\n  const images = Array.from(document.images) as HTMLImageElement[];\r\n  for (const img of images) {\r\n    if (!shouldTrackImage(img)) {\r\n      continue;\r\n    }\r\n    attachBadge(img);\r\n  }\r\n}\r\n\r\nfunction shouldTrackImage(img: HTMLImageElement) {\r\n  if (trackedImages.has(img)) {\r\n    return false;\r\n  }\r\n  if (trackedImages.size >= MAX_TRACKED_IMAGES) {\r\n    return false;\r\n  }\r\n  if (!img.src) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction attachBadge(img: HTMLImageElement) {\r\n  const badge = document.createElement(\"div\");\r\n  badge.className = \"imagion-badge\";\r\n  badge.setAttribute(\"role\", \"status\");\r\n  badge.setAttribute(\"lang\", localeCode);\r\n  badge.innerHTML = `<span class=\"imagion-badge__logo\">I</span><span class=\"imagion-badge__label\">${localized.badgePrefix}</span>`;\r\n  updateBadgeAria(badge, localized.badgePrefix);\r\n  badge.dataset.requestState = \"pending\";\r\n  const badgeId = `imagion-${++badgeCounter}`;\r\n  badge.dataset.requestId = badgeId;\r\n  document.body.appendChild(badge);\r\n  trackedImages.set(img, { badge });\r\n  schedulePositionUpdate();\r\n  requestDetection(img, badge, badgeId);\r\n}\r\n\r\nfunction updateBadgePosition(img: HTMLImageElement, badge: HTMLDivElement) {\r\n  const rect = img.getBoundingClientRect();\r\n  if (rect.width === 0 || rect.height === 0) {\r\n    badge.style.display = \"none\";\r\n    return;\r\n  }\r\n  badge.style.display = \"inline-flex\";\r\n  const offset = 6;\r\n  const x = window.scrollX + rect.left + rect.width - badge.offsetWidth - offset;\r\n  const y = window.scrollY + rect.top + offset;\r\n  badge.style.transform = `translate(${x}px, ${y}px)`;\r\n}\r\n\r\nfunction requestDetection(img: HTMLImageElement, badge: HTMLDivElement, badgeId: string) {\r\n  const imageUrl = img.currentSrc || img.src;\r\n  if (!imageUrl || imageUrl.startsWith(\"data:\")) {\r\n    updateBadgeFromResponse(badge, {\r\n      status: \"error\",\r\n      message: \"Unable to analyze data URI.\",\r\n      badgeId,\r\n    });\r\n    return;\r\n  }\r\n\r\n  const payload = {\r\n    type: \"REQUEST_DETECTION\" as const,\r\n    imageUrl,\r\n    badgeId,\r\n    pageUrl: window.location.href,\r\n  };\r\n\r\n  sendDetectionRequest(payload)\r\n    .then((response) => {\r\n      updateBadgeFromResponse(badge, response);\r\n    })\r\n    .catch((error) => {\r\n      updateBadgeFromResponse(badge, {\r\n        status: \"error\",\r\n        message: error?.message || \"Detection request failed.\",\r\n        badgeId,\r\n      });\r\n    });\r\n}\r\n\r\nfunction sendDetectionRequest(payload: {\r\n  type: \"REQUEST_DETECTION\";\r\n  imageUrl: string;\r\n  badgeId: string;\r\n  pageUrl: string;\r\n}): Promise<BadgeResponse> {\r\n  return new Promise((resolve) => {\r\n    chrome.runtime.sendMessage(payload, (response) => {\r\n      if (chrome.runtime.lastError) {\r\n        resolve({\r\n          status: \"error\",\r\n          message: chrome.runtime.lastError.message,\r\n          badgeId: payload.badgeId,\r\n        });\r\n        return;\r\n      }\r\n      resolve(response as BadgeResponse);\r\n    });\r\n  });\r\n}\r\n\r\nfunction updateBadgeFromResponse(badge: HTMLDivElement, response: BadgeResponse) {\r\n  if (!badge || !response) {\r\n    return;\r\n  }\r\n\r\n  if (badge.dataset.requestId !== response.badgeId) {\r\n    return;\r\n  }\r\n\r\n  const label = badge.querySelector(\".imagion-badge__label\");\r\n  if (!label) {\r\n    return;\r\n  }\r\n\r\n  badge.classList.remove(\r\n    \"imagion-badge--ai\",\r\n    \"imagion-badge--real\",\r\n    \"imagion-badge--error\",\r\n    \"imagion-badge--missing-key\"\r\n  );\r\n\r\n  if (response.status === \"success\" && response.verdict) {\r\n    const verdict = response.verdict.toLowerCase();\r\n    if (verdict === \"ai\" || verdict === \"fake\") {\r\n      badge.classList.add(\"imagion-badge--ai\");\r\n      label.textContent = localized.aiLabel;\r\n      updateBadgeAria(badge, localized.aiLabel);\r\n    } else if (verdict === \"real\") {\r\n      badge.classList.add(\"imagion-badge--real\");\r\n      label.textContent = localized.realLabel;\r\n      updateBadgeAria(badge, localized.realLabel);\r\n    } else {\r\n      badge.classList.add(\"imagion-badge--real\");\r\n      label.textContent = localized.realLabel;\r\n      updateBadgeAria(badge, localized.realLabel);\r\n    }\r\n    badge.title = createTooltip(response);\r\n    badge.dataset.requestState = \"success\";\r\n  } else if (response.status === \"missing-key\") {\r\n    badge.classList.add(\"imagion-badge--missing-key\");\r\n    label.textContent = localized.loginLabel;\r\n    updateBadgeAria(badge, localized.loginLabel);\r\n    badge.title = response.message || \"Add your API key via the Imagion extension options.\";\r\n    badge.dataset.requestState = \"key-required\";\r\n  } else if (response.status === \"rate-limit\") {\r\n    badge.classList.add(\"imagion-badge--error\");\r\n    label.textContent = localized.rateLimitLabel;\r\n    updateBadgeAria(badge, localized.rateLimitLabel);\r\n    badge.title = response.message || localized.disabledHostMessage;\r\n    badge.dataset.requestState = \"rate-limit\";\r\n  } else {\r\n    badge.classList.add(\"imagion-badge--error\");\r\n    label.textContent = localized.errorLabel;\r\n    updateBadgeAria(badge, localized.errorLabel);\r\n    badge.title = response.message || \"Detection failed.\";\r\n    badge.dataset.requestState = \"error\";\r\n  }\r\n}\r\n\r\nfunction updateBadgeAria(badge: HTMLDivElement, text: string) {\r\n  badge.setAttribute(\"aria-label\", `${localized.badgePrefix}: ${text}`);\r\n}\r\n\r\nfunction createTooltip(response: BadgeResponse) {\r\n  const parts: string[] = [];\r\n  if (response.score != null) {\r\n    parts.push(`Score ${Number(response.score).toFixed(2)}`);\r\n  }\r\n  if (response.confidence != null) {\r\n    parts.push(`Confidence ${Number(response.confidence).toFixed(2)}`);\r\n  }\r\n  if (response.presentation) {\r\n    parts.push(response.presentation);\r\n  }\r\n  if (response.retryAfterSeconds) {\r\n    parts.push(`Retry in ${response.retryAfterSeconds}s`);\r\n  }\r\n  return parts.length ? parts.join(\" | \") : localized.tooltipFallback;\r\n}\r\n\r\nfunction removeAllBadges() {\r\n  for (const [, meta] of trackedImages) {\r\n    meta.badge.remove();\r\n  }\r\n  trackedImages.clear();\r\n}\r\n\r\nfunction updateDisabledHosts(items: Record<string, unknown>) {\r\n  const storedHosts = Array.isArray(items.imagionDisabledHosts) ? items.imagionDisabledHosts : [];\r\n  const normalized = storedHosts\r\n    .map((host) => normalizeHostname(host))\r\n    .filter((value): value is string => Boolean(value));\r\n  disabledHostsSet = new Set(normalized);\r\n}\r\n\r\nfunction normalizeHostname(value: string): string | null {\r\n  const trimmed = value.trim();\r\n  if (!trimmed) {\r\n    return null;\r\n  }\r\n  try {\r\n    const parsed = trimmed.includes(\"://\") ? new URL(trimmed) : new URL(`https://${trimmed}`);\r\n    return parsed.hostname.toLowerCase();\r\n  } catch {\r\n    return trimmed.toLowerCase();\r\n  }\r\n}\r\n\r\nfunction isHostBlocked(host: string) {\r\n  const normalized = normalizeHostname(host);\r\n  if (!normalized) {\r\n    return false;\r\n  }\r\n  const candidate = normalized.startsWith(\"www.\") ? normalized.slice(4) : normalized;\r\n  return disabledHostsSet.has(normalized) || disabledHostsSet.has(candidate);\r\n}\r\n\r\nlet disabledHostsSet = new Set<string>();\r\n\r\nfunction syncSettings() {\r\n  chrome.storage.local.get(\r\n    { imagionBadgeEnabled: true, imagionDisabledHosts: [] },\r\n    (items) => {\r\n      const enabled = items.imagionBadgeEnabled !== false;\r\n      state.enabled = enabled;\r\n      updateDisabledHosts(items);\r\n      if (shouldSkipScanning()) {\r\n        removeAllBadges();\r\n        return;\r\n      }\r\n      if (state.enabled) {\r\n        scheduleScan();\r\n      } else {\r\n        removeAllBadges();\r\n      }\r\n    }\r\n  );\r\n}\r\n\r\nfunction init() {\r\n  insertBadgeStyles();\r\n  syncSettings();\r\n\r\n  scanForImages();\r\n  schedulePositionUpdate();\r\n\r\n  const observerTarget = document.documentElement || document.body;\r\n  if (observerTarget) {\r\n    const mutationObserver = new MutationObserver(() => scheduleScan());\r\n    mutationObserver.observe(observerTarget, { childList: true, subtree: true });\r\n  }\r\n\r\n  window.addEventListener(\"scroll\", schedulePositionUpdate, { passive: true });\r\n  window.addEventListener(\"resize\", schedulePositionUpdate);\r\n  chrome.storage.onChanged.addListener(syncSettings);\r\n}\r\n\r\nif (document.readyState === \"loading\") {\r\n  document.addEventListener(\"DOMContentLoaded\", init);\r\n} else {\r\n  init();\r\n}\r\n\r\nexport {};\r\n"],"names":["STYLE_ID","trackedImages","badgeCounter","positionScheduled","scanScheduled","state","TRANSLATIONS","localeCode","localized","badgeStyle","insertBadgeStyles","style","schedulePositionUpdate","updateAllBadgePositions","scheduleScan","scanForImages","img","meta","updateBadgePosition","shouldSkipScanning","isHostBlocked","removeAllBadges","images","shouldTrackImage","attachBadge","badge","updateBadgeAria","badgeId","requestDetection","rect","offset","x","y","imageUrl","updateBadgeFromResponse","payload","sendDetectionRequest","response","error","resolve","label","verdict","createTooltip","text","parts","updateDisabledHosts","items","normalized","host","normalizeHostname","value","disabledHostsSet","trimmed","candidate","syncSettings","enabled","init","observerTarget"],"mappings":"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"}