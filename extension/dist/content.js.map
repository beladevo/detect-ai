{"version":3,"file":"content.js","sources":["../src/content.ts"],"sourcesContent":["const LOG_PREFIX = \"[Imagion Content]\";\r\nconst STYLE_ID = \"imagion-badge-style\";\r\nconst MAX_TRACKED_IMAGES = 200;\r\nconst MIN_IMAGE_SIZE = 50; // Minimum width/height to track\r\n\r\n// Skip extension on our own domains to prevent React hydration errors\r\nconst EXCLUDED_DOMAINS = [\r\n  \"localhost\",\r\n  \"127.0.0.1\",\r\n  \"imagion.ai\",\r\n  \"www.imagion.ai\",\r\n];\r\nconst trackedImages = new Map<HTMLImageElement, { badge: HTMLDivElement; wrapper: HTMLSpanElement }>();\r\nlet badgeCounter = 0;\r\nlet positionScheduled = false;\r\nlet scanScheduled = false;\r\nconst state = {\r\n  enabled: true,\r\n};\r\n\r\ntype BadgeResponse = {\r\n  status?: \"success\" | \"missing-key\" | \"error\" | \"rate-limit\";\r\n  verdict?: string;\r\n  score?: number;\r\n  confidence?: number;\r\n  presentation?: string;\r\n  message?: string;\r\n  badgeId: string;\r\n  imageUrl?: string;\r\n  retryAfterSeconds?: number;\r\n  badgeLabel?: string;\r\n  hash?: string;\r\n};\r\n\r\ntype ContentLocaleStrings = {\r\n  aiLabel: string;\r\n  realLabel: string;\r\n  errorLabel: string;\r\n  loginLabel: string;\r\n  badgePrefix: string;\r\n  tooltipFallback: string;\r\n  rateLimitLabel: string;\r\n  disabledHostMessage: string;\r\n};\r\n\r\nconst TRANSLATIONS: Record<string, ContentLocaleStrings> = {\r\n  en: {\r\n    aiLabel: \"AI\",\r\n    realLabel: \"Real\",\r\n    errorLabel: \"Error\",\r\n    loginLabel: \"Log in\",\r\n    badgePrefix: \"Imagion badge\",\r\n    tooltipFallback: \"Imagion verdict\",\r\n    rateLimitLabel: \"Rate limited\",\r\n    disabledHostMessage: \"Badges paused on this host.\",\r\n  },\r\n  es: {\r\n    aiLabel: \"IA\",\r\n    realLabel: \"Real\",\r\n    errorLabel: \"Error\",\r\n    loginLabel: \"Iniciar sesión\",\r\n    badgePrefix: \"Insignia Imagion\",\r\n    tooltipFallback: \"Veredicto de Imagion\",\r\n    rateLimitLabel: \"Límite de velocidad\",\r\n    disabledHostMessage: \"Insignias pausadas en este host.\",\r\n  },\r\n};\r\n\r\nconst localeCode = navigator.language.split(\"-\")[0];\r\nconst localized = TRANSLATIONS[localeCode] ?? TRANSLATIONS.en;\r\n\r\nconst badgeStyle = `\r\n.imagion-wrapper {\r\n  position: relative !important;\r\n  display: inline-block !important;\r\n}\r\n.imagion-badge {\r\n  position: absolute !important;\r\n  top: 6px !important;\r\n  right: 6px !important;\r\n  pointer-events: auto !important;\r\n  cursor: default !important;\r\n  display: inline-flex !important;\r\n  align-items: center !important;\r\n  gap: 4px !important;\r\n  padding: 3px 8px !important;\r\n  font-size: 11px !important;\r\n  font-weight: 600 !important;\r\n  border-radius: 4px !important;\r\n  background: rgba(100, 100, 100, 0.9) !important;\r\n  color: #fff !important;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4) !important;\r\n  letter-spacing: 0.02em !important;\r\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif !important;\r\n  text-transform: uppercase !important;\r\n  white-space: nowrap !important;\r\n  margin: 0 !important;\r\n  border: none !important;\r\n  text-decoration: none !important;\r\n  line-height: 1.2 !important;\r\n  z-index: 10000 !important;\r\n}\r\n.imagion-badge__logo {\r\n  width: 14px !important;\r\n  height: 14px !important;\r\n  display: inline-flex !important;\r\n  align-items: center !important;\r\n  justify-content: center !important;\r\n  border-radius: 3px !important;\r\n  background: #fff !important;\r\n  color: #1a1a2e !important;\r\n  font-size: 9px !important;\r\n  font-weight: 700 !important;\r\n  margin: 0 !important;\r\n  padding: 0 !important;\r\n}\r\n.imagion-badge__label {\r\n  line-height: 1 !important;\r\n}\r\n.imagion-badge--pending {\r\n  background: rgba(100, 100, 100, 0.9) !important;\r\n}\r\n.imagion-badge--ai {\r\n  background: rgba(220, 53, 69, 0.95) !important;\r\n}\r\n.imagion-badge--real {\r\n  background: rgba(40, 167, 69, 0.95) !important;\r\n}\r\n.imagion-badge--error {\r\n  background: rgba(255, 69, 96, 0.9) !important;\r\n}\r\n.imagion-badge--missing-key {\r\n  background: rgba(255, 193, 7, 0.95) !important;\r\n  color: #1a1a1a !important;\r\n}\r\n\r\n/* Hover Card Styles - MagicUI inspired */\r\n.imagion-hover-card {\r\n  position: absolute !important;\r\n  top: 100% !important;\r\n  right: 0 !important;\r\n  margin-top: 8px !important;\r\n  min-width: 220px !important;\r\n  max-width: 280px !important;\r\n  padding: 12px 14px !important;\r\n  background: rgba(15, 15, 20, 0.85) !important;\r\n  backdrop-filter: blur(12px) !important;\r\n  -webkit-backdrop-filter: blur(12px) !important;\r\n  border: 1px solid rgba(255, 255, 255, 0.1) !important;\r\n  border-radius: 10px !important;\r\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.05) inset !important;\r\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif !important;\r\n  color: #fff !important;\r\n  z-index: 10001 !important;\r\n  opacity: 0 !important;\r\n  visibility: hidden !important;\r\n  transform: translateY(-4px) !important;\r\n  transition: opacity 0.2s ease, transform 0.2s ease, visibility 0.2s !important;\r\n  pointer-events: none !important;\r\n}\r\n.imagion-badge:hover .imagion-hover-card {\r\n  opacity: 1 !important;\r\n  visibility: visible !important;\r\n  transform: translateY(0) !important;\r\n  pointer-events: auto !important;\r\n}\r\n.imagion-hover-card__header {\r\n  display: flex !important;\r\n  align-items: center !important;\r\n  gap: 8px !important;\r\n  margin-bottom: 10px !important;\r\n  padding-bottom: 8px !important;\r\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;\r\n}\r\n.imagion-hover-card__verdict {\r\n  font-size: 14px !important;\r\n  font-weight: 600 !important;\r\n  text-transform: uppercase !important;\r\n  letter-spacing: 0.05em !important;\r\n}\r\n.imagion-hover-card__verdict--ai {\r\n  color: #ff6b7a !important;\r\n}\r\n.imagion-hover-card__verdict--real {\r\n  color: #6bff8e !important;\r\n}\r\n.imagion-hover-card__verdict--error {\r\n  color: #ffaa6b !important;\r\n}\r\n.imagion-hover-card__row {\r\n  display: flex !important;\r\n  justify-content: space-between !important;\r\n  align-items: center !important;\r\n  margin-bottom: 6px !important;\r\n  font-size: 12px !important;\r\n}\r\n.imagion-hover-card__label {\r\n  color: rgba(255, 255, 255, 0.6) !important;\r\n  font-weight: 400 !important;\r\n}\r\n.imagion-hover-card__value {\r\n  color: #fff !important;\r\n  font-weight: 500 !important;\r\n}\r\n.imagion-hover-card__bar {\r\n  height: 4px !important;\r\n  background: rgba(255, 255, 255, 0.1) !important;\r\n  border-radius: 2px !important;\r\n  overflow: hidden !important;\r\n  margin-top: 4px !important;\r\n  margin-bottom: 8px !important;\r\n}\r\n.imagion-hover-card__bar-fill {\r\n  height: 100% !important;\r\n  border-radius: 2px !important;\r\n  transition: width 0.3s ease !important;\r\n}\r\n.imagion-hover-card__bar-fill--ai {\r\n  background: linear-gradient(90deg, #ff6b7a, #ff4d67) !important;\r\n}\r\n.imagion-hover-card__bar-fill--real {\r\n  background: linear-gradient(90deg, #6bff8e, #28a745) !important;\r\n}\r\n.imagion-hover-card__hash {\r\n  margin-top: 10px !important;\r\n  padding-top: 8px !important;\r\n  border-top: 1px solid rgba(255, 255, 255, 0.08) !important;\r\n  font-size: 9px !important;\r\n  color: rgba(255, 255, 255, 0.35) !important;\r\n  font-family: \"SF Mono\", Monaco, \"Cascadia Code\", monospace !important;\r\n  word-break: break-all !important;\r\n  line-height: 1.4 !important;\r\n}\r\n.imagion-hover-card__hash-label {\r\n  color: rgba(255, 255, 255, 0.5) !important;\r\n  font-size: 9px !important;\r\n  text-transform: uppercase !important;\r\n  letter-spacing: 0.05em !important;\r\n  margin-bottom: 2px !important;\r\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif !important;\r\n}\r\n.imagion-hover-card__message {\r\n  font-size: 11px !important;\r\n  color: rgba(255, 255, 255, 0.7) !important;\r\n  line-height: 1.4 !important;\r\n  margin-top: 6px !important;\r\n}\r\n`;\r\n\r\nfunction insertBadgeStyles() {\r\n  if (document.getElementById(STYLE_ID)) {\r\n    return;\r\n  }\r\n  const style = document.createElement(\"style\");\r\n  style.id = STYLE_ID;\r\n  style.textContent = badgeStyle;\r\n  (document.head || document.documentElement).appendChild(style);\r\n  console.debug(LOG_PREFIX, \"Badge styles injected\");\r\n}\r\n\r\nfunction schedulePositionUpdate() {\r\n  if (positionScheduled) {\r\n    return;\r\n  }\r\n  positionScheduled = true;\r\n  requestAnimationFrame(() => {\r\n    positionScheduled = false;\r\n    updateAllBadgePositions();\r\n  });\r\n}\r\n\r\nfunction scheduleScan() {\r\n  if (scanScheduled) {\r\n    return;\r\n  }\r\n  scanScheduled = true;\r\n  requestAnimationFrame(() => {\r\n    scanScheduled = false;\r\n    scanForImages();\r\n  });\r\n}\r\n\r\nfunction updateAllBadgePositions() {\r\n  for (const [img, meta] of trackedImages) {\r\n    if (!img.isConnected) {\r\n      removeBadgeAndWrapper(img, meta);\r\n      trackedImages.delete(img);\r\n    }\r\n  }\r\n}\r\n\r\nfunction removeBadgeAndWrapper(img: HTMLImageElement, meta: { badge: HTMLDivElement; wrapper: HTMLSpanElement }) {\r\n  const { badge, wrapper } = meta;\r\n  badge.remove();\r\n  // Restore image to its original position\r\n  if (wrapper.parentNode) {\r\n    wrapper.parentNode.insertBefore(img, wrapper);\r\n    wrapper.remove();\r\n  }\r\n}\r\n\r\nfunction isExcludedDomain(hostname: string) {\r\n  const normalized = hostname.toLowerCase();\r\n  return EXCLUDED_DOMAINS.some((domain) => normalized === domain || normalized.endsWith(`.${domain}`));\r\n}\r\n\r\nfunction shouldSkipScanning() {\r\n  return !state.enabled || isHostBlocked(window.location.hostname) || isExcludedDomain(window.location.hostname);\r\n}\r\n\r\nfunction scanForImages() {\r\n  if (shouldSkipScanning()) {\r\n    console.debug(LOG_PREFIX, \"Scanning skipped (disabled or host blocked)\");\r\n    removeAllBadges();\r\n    return;\r\n  }\r\n  const images = Array.from(document.images) as HTMLImageElement[];\r\n  const newImages = images.filter((img) => shouldTrackImage(img));\r\n  if (newImages.length > 0) {\r\n    console.debug(LOG_PREFIX, `Found ${newImages.length} new images to track (total on page: ${images.length})`);\r\n  }\r\n  for (const img of newImages) {\r\n    attachBadge(img);\r\n  }\r\n}\r\n\r\nfunction shouldTrackImage(img: HTMLImageElement) {\r\n  if (trackedImages.has(img)) {\r\n    return false;\r\n  }\r\n  if (trackedImages.size >= MAX_TRACKED_IMAGES) {\r\n    return false;\r\n  }\r\n  if (!img.src) {\r\n    return false;\r\n  }\r\n  // Skip data URIs\r\n  if (img.src.startsWith(\"data:\")) {\r\n    return false;\r\n  }\r\n  // Skip tiny images (icons, avatars, etc.)\r\n  const rect = img.getBoundingClientRect();\r\n  if (rect.width < MIN_IMAGE_SIZE || rect.height < MIN_IMAGE_SIZE) {\r\n    return false;\r\n  }\r\n  // Skip images that are not visible\r\n  if (rect.width === 0 || rect.height === 0) {\r\n    return false;\r\n  }\r\n  return true;\r\n}\r\n\r\nfunction attachBadge(img: HTMLImageElement) {\r\n  const badge = document.createElement(\"div\");\r\n  badge.className = \"imagion-badge imagion-badge--pending\";\r\n  badge.setAttribute(\"role\", \"status\");\r\n  badge.setAttribute(\"lang\", localeCode);\r\n  badge.innerHTML = `<span class=\"imagion-badge__logo\">I</span><span class=\"imagion-badge__label\">...</span>`;\r\n  updateBadgeAria(badge, \"Analyzing\");\r\n  badge.dataset.requestState = \"pending\";\r\n  const badgeId = `imagion-${++badgeCounter}`;\r\n  badge.dataset.requestId = badgeId;\r\n\r\n  // Wrap image in a container and insert badge as sibling\r\n  const wrapper = document.createElement(\"span\");\r\n  wrapper.className = \"imagion-wrapper\";\r\n\r\n  // Match the image's z-index\r\n  const computedStyle = window.getComputedStyle(img);\r\n  const imgZIndex = computedStyle.zIndex;\r\n  if (imgZIndex && imgZIndex !== \"auto\") {\r\n    wrapper.style.zIndex = imgZIndex;\r\n  }\r\n\r\n  const parent = img.parentNode;\r\n  if (parent) {\r\n    parent.insertBefore(wrapper, img);\r\n    wrapper.appendChild(img);\r\n    wrapper.appendChild(badge);\r\n  }\r\n\r\n  trackedImages.set(img, { badge, wrapper });\r\n\r\n  requestDetection(img, badge, badgeId);\r\n}\r\n\r\nfunction requestDetection(img: HTMLImageElement, badge: HTMLDivElement, badgeId: string) {\r\n  const imageUrl = img.currentSrc || img.src;\r\n  if (!imageUrl || imageUrl.startsWith(\"data:\")) {\r\n    console.debug(LOG_PREFIX, `Skipping data URI for ${badgeId}`);\r\n    updateBadgeFromResponse(badge, {\r\n      status: \"error\",\r\n      message: \"Unable to analyze data URI.\",\r\n      badgeId,\r\n    });\r\n    return;\r\n  }\r\n\r\n  console.debug(LOG_PREFIX, `Requesting detection for ${badgeId}:`, imageUrl.substring(0, 100));\r\n\r\n  const payload = {\r\n    type: \"REQUEST_DETECTION\" as const,\r\n    imageUrl,\r\n    badgeId,\r\n    pageUrl: window.location.href,\r\n  };\r\n\r\n  sendDetectionRequest(payload)\r\n    .then((response) => {\r\n      console.debug(LOG_PREFIX, `Response for ${badgeId}:`, response.status, response.verdict || response.message);\r\n      updateBadgeFromResponse(badge, response);\r\n    })\r\n    .catch((error) => {\r\n      console.error(LOG_PREFIX, `Error for ${badgeId}:`, error);\r\n      updateBadgeFromResponse(badge, {\r\n        status: \"error\",\r\n        message: error?.message || \"Detection request failed.\",\r\n        badgeId,\r\n      });\r\n    });\r\n}\r\n\r\nfunction sendDetectionRequest(payload: {\r\n  type: \"REQUEST_DETECTION\";\r\n  imageUrl: string;\r\n  badgeId: string;\r\n  pageUrl: string;\r\n}): Promise<BadgeResponse> {\r\n  return new Promise((resolve) => {\r\n    chrome.runtime.sendMessage(payload, (response) => {\r\n      if (chrome.runtime.lastError) {\r\n        console.error(LOG_PREFIX, \"Runtime error:\", chrome.runtime.lastError.message);\r\n        resolve({\r\n          status: \"error\",\r\n          message: chrome.runtime.lastError.message,\r\n          badgeId: payload.badgeId,\r\n        });\r\n        return;\r\n      }\r\n      resolve(response as BadgeResponse);\r\n    });\r\n  });\r\n}\r\n\r\nfunction updateBadgeFromResponse(badge: HTMLDivElement, response: BadgeResponse) {\r\n  if (!badge || !response) {\r\n    return;\r\n  }\r\n\r\n  if (badge.dataset.requestId !== response.badgeId) {\r\n    return;\r\n  }\r\n\r\n  const label = badge.querySelector(\".imagion-badge__label\");\r\n  if (!label) {\r\n    return;\r\n  }\r\n\r\n  badge.classList.remove(\r\n    \"imagion-badge--pending\",\r\n    \"imagion-badge--ai\",\r\n    \"imagion-badge--real\",\r\n    \"imagion-badge--error\",\r\n    \"imagion-badge--missing-key\"\r\n  );\r\n\r\n  // Remove existing hover card if any\r\n  const existingCard = badge.querySelector(\".imagion-hover-card\");\r\n  if (existingCard) {\r\n    existingCard.remove();\r\n  }\r\n\r\n  // Handle success: either explicit status=\"success\" OR has a verdict (for cached responses without status)\r\n  const isSuccess = (response.status === \"success\" || response.status === undefined) && response.verdict;\r\n\r\n  if (isSuccess) {\r\n    const verdict = response.verdict!.toLowerCase();\r\n    if (verdict === \"ai\" || verdict === \"fake\" || verdict === \"ai_generated\" || verdict === \"likely_ai\") {\r\n      badge.classList.add(\"imagion-badge--ai\");\r\n      label.textContent = localized.aiLabel;\r\n      updateBadgeAria(badge, localized.aiLabel);\r\n    } else {\r\n      badge.classList.add(\"imagion-badge--real\");\r\n      label.textContent = localized.realLabel;\r\n      updateBadgeAria(badge, localized.realLabel);\r\n    }\r\n    badge.dataset.requestState = \"success\";\r\n  } else if (response.status === \"missing-key\") {\r\n    badge.classList.add(\"imagion-badge--missing-key\");\r\n    label.textContent = localized.loginLabel;\r\n    updateBadgeAria(badge, localized.loginLabel);\r\n    badge.dataset.requestState = \"key-required\";\r\n  } else if (response.status === \"rate-limit\") {\r\n    const rateLimitLabel = response.badgeLabel ?? localized.rateLimitLabel;\r\n    badge.classList.add(\"imagion-badge--error\");\r\n    label.textContent = rateLimitLabel;\r\n    updateBadgeAria(badge, rateLimitLabel);\r\n    badge.dataset.requestState = \"rate-limit\";\r\n  } else {\r\n    console.error(LOG_PREFIX, `Badge error for ${response.badgeId}:`, {\r\n      status: response.status,\r\n      verdict: response.verdict,\r\n      message: response.message,\r\n      imageUrl: response.imageUrl,\r\n      fullResponse: response,\r\n    });\r\n    badge.classList.add(\"imagion-badge--error\");\r\n    label.textContent = localized.errorLabel;\r\n    updateBadgeAria(badge, localized.errorLabel);\r\n    badge.dataset.requestState = \"error\";\r\n  }\r\n\r\n  // Add hover card with details\r\n  badge.title = \"\"; // Clear native tooltip\r\n  const hoverCard = createHoverCard(response);\r\n  badge.appendChild(hoverCard);\r\n}\r\n\r\nfunction updateBadgeAria(badge: HTMLDivElement, text: string) {\r\n  badge.setAttribute(\"aria-label\", `${localized.badgePrefix}: ${text}`);\r\n}\r\n\r\nfunction createHoverCard(response: BadgeResponse): HTMLDivElement {\r\n  const card = document.createElement(\"div\");\r\n  card.className = \"imagion-hover-card\";\r\n\r\n  const verdict = response.verdict?.toLowerCase() || \"\";\r\n  const isAI = verdict === \"ai\" || verdict === \"fake\" || verdict === \"ai_generated\" || verdict === \"likely_ai\";\r\n  // Handle success: either explicit status=\"success\" OR has a verdict (for cached responses without status)\r\n  const isSuccess = (response.status === \"success\" || response.status === undefined) && response.verdict;\r\n\r\n  let html = \"\";\r\n\r\n  // Header with verdict\r\n  if (isSuccess) {\r\n    const verdictClass = isAI ? \"imagion-hover-card__verdict--ai\" : \"imagion-hover-card__verdict--real\";\r\n    const verdictLabel = isAI ? \"AI Generated\" : \"Real Image\";\r\n    html += `<div class=\"imagion-hover-card__header\">\r\n      <span class=\"imagion-hover-card__verdict ${verdictClass}\">${verdictLabel}</span>\r\n    </div>`;\r\n  } else if (response.status === \"error\" || response.status === \"rate-limit\") {\r\n    html += `<div class=\"imagion-hover-card__header\">\r\n      <span class=\"imagion-hover-card__verdict imagion-hover-card__verdict--error\">${response.status === \"rate-limit\" ? \"Rate Limited\" : \"Error\"}</span>\r\n    </div>`;\r\n  }\r\n\r\n  // Score bar (only show for success)\r\n  if (response.score != null && isSuccess) {\r\n    const rawScore = Number(response.score);\r\n    // Handle both 0-1 range and 0-100 range\r\n    const scorePercent = rawScore > 1 ? Math.round(rawScore) : Math.round(rawScore * 100);\r\n    const barClass = isAI ? \"imagion-hover-card__bar-fill--ai\" : \"imagion-hover-card__bar-fill--real\";\r\n    html += `<div class=\"imagion-hover-card__row\">\r\n      <span class=\"imagion-hover-card__label\">AI Score</span>\r\n      <span class=\"imagion-hover-card__value\">${scorePercent}%</span>\r\n    </div>\r\n    <div class=\"imagion-hover-card__bar\">\r\n      <div class=\"imagion-hover-card__bar-fill ${barClass}\" style=\"width: ${Math.min(scorePercent, 100)}%\"></div>\r\n    </div>`;\r\n  }\r\n\r\n  // Confidence (only show for success)\r\n  if (response.confidence != null && isSuccess) {\r\n    const rawConfidence = Number(response.confidence);\r\n    // Handle both 0-1 range and 0-100 range\r\n    const confidencePercent = rawConfidence > 1 ? Math.round(rawConfidence) : Math.round(rawConfidence * 100);\r\n    html += `<div class=\"imagion-hover-card__row\">\r\n      <span class=\"imagion-hover-card__label\">Confidence</span>\r\n      <span class=\"imagion-hover-card__value\">${confidencePercent}%</span>\r\n    </div>`;\r\n  }\r\n\r\n  // Message (for errors) - always show for non-success states\r\n  if (!isSuccess) {\r\n    const errorMessage = response.message || \"Detection failed. Please try again.\";\r\n    html += `<div class=\"imagion-hover-card__message\">${escapeHtml(errorMessage)}</div>`;\r\n  }\r\n\r\n  // Hash\r\n  if (response.hash) {\r\n    const shortHash = response.hash.substring(0, 16) + \"...\" + response.hash.substring(response.hash.length - 8);\r\n    html += `<div class=\"imagion-hover-card__hash\">\r\n      <div class=\"imagion-hover-card__hash-label\">SHA-256</div>\r\n      ${shortHash}\r\n    </div>`;\r\n  }\r\n\r\n  card.innerHTML = html;\r\n  return card;\r\n}\r\n\r\nfunction escapeHtml(text: string): string {\r\n  const div = document.createElement(\"div\");\r\n  div.textContent = text;\r\n  return div.innerHTML;\r\n}\r\n\r\nfunction removeAllBadges() {\r\n  const count = trackedImages.size;\r\n  for (const [img, meta] of trackedImages) {\r\n    removeBadgeAndWrapper(img, meta);\r\n  }\r\n  trackedImages.clear();\r\n  if (count > 0) {\r\n    console.debug(LOG_PREFIX, `Removed ${count} badges`);\r\n  }\r\n}\r\n\r\nfunction updateDisabledHosts(items: Record<string, unknown>) {\r\n  const storedHosts = Array.isArray(items.imagionDisabledHosts) ? items.imagionDisabledHosts : [];\r\n  const normalized = storedHosts\r\n    .map((host) => normalizeHostname(host))\r\n    .filter((value): value is string => Boolean(value));\r\n  disabledHostsSet = new Set(normalized);\r\n  if (normalized.length > 0) {\r\n    console.info(LOG_PREFIX, \"Disabled hosts:\", normalized);\r\n  }\r\n}\r\n\r\nfunction normalizeHostname(value: string): string | null {\r\n  const trimmed = value.trim();\r\n  if (!trimmed) {\r\n    return null;\r\n  }\r\n  try {\r\n    const parsed = trimmed.includes(\"://\") ? new URL(trimmed) : new URL(`https://${trimmed}`);\r\n    return parsed.hostname.toLowerCase();\r\n  } catch {\r\n    return trimmed.toLowerCase();\r\n  }\r\n}\r\n\r\nfunction isHostBlocked(host: string) {\r\n  const normalized = normalizeHostname(host);\r\n  if (!normalized) {\r\n    return false;\r\n  }\r\n  const candidate = normalized.startsWith(\"www.\") ? normalized.slice(4) : normalized;\r\n  return disabledHostsSet.has(normalized) || disabledHostsSet.has(candidate);\r\n}\r\n\r\nlet disabledHostsSet = new Set<string>();\r\n\r\nfunction syncSettings() {\r\n  chrome.storage.local.get(\r\n    { imagionBadgeEnabled: true, imagionDisabledHosts: [] },\r\n    (items) => {\r\n      const enabled = items.imagionBadgeEnabled !== false;\r\n      state.enabled = enabled;\r\n      updateDisabledHosts(items);\r\n\r\n      console.info(LOG_PREFIX, \"Settings synced:\", { enabled, hostBlocked: isHostBlocked(window.location.hostname) });\r\n\r\n      if (shouldSkipScanning()) {\r\n        removeAllBadges();\r\n        return;\r\n      }\r\n      if (state.enabled) {\r\n        scheduleScan();\r\n      } else {\r\n        removeAllBadges();\r\n      }\r\n    }\r\n  );\r\n}\r\n\r\nfunction init() {\r\n  console.info(LOG_PREFIX, \"Initializing on\", window.location.hostname);\r\n\r\n  // Skip entirely on our own domains to prevent React hydration issues\r\n  if (isExcludedDomain(window.location.hostname)) {\r\n    console.info(LOG_PREFIX, \"Skipping on excluded domain:\", window.location.hostname);\r\n    return;\r\n  }\r\n\r\n  insertBadgeStyles();\r\n  syncSettings();\r\n\r\n  // Initial scan after a short delay to let images load\r\n  setTimeout(() => {\r\n    scanForImages();\r\n    schedulePositionUpdate();\r\n  }, 500);\r\n\r\n  const observerTarget = document.documentElement || document.body;\r\n  if (observerTarget) {\r\n    const mutationObserver = new MutationObserver(() => scheduleScan());\r\n    mutationObserver.observe(observerTarget, { childList: true, subtree: true });\r\n    console.debug(LOG_PREFIX, \"MutationObserver attached\");\r\n  }\r\n\r\n  window.addEventListener(\"scroll\", schedulePositionUpdate, { passive: true });\r\n  window.addEventListener(\"resize\", schedulePositionUpdate);\r\n  chrome.storage.onChanged.addListener(syncSettings);\r\n\r\n  console.info(LOG_PREFIX, \"Initialization complete\");\r\n}\r\n\r\nif (document.readyState === \"loading\") {\r\n  document.addEventListener(\"DOMContentLoaded\", init);\r\n} else {\r\n  init();\r\n}\r\n\r\nexport {};\r\n"],"names":["LOG_PREFIX","STYLE_ID","EXCLUDED_DOMAINS","trackedImages","badgeCounter","positionScheduled","scanScheduled","state","TRANSLATIONS","localeCode","localized","badgeStyle","insertBadgeStyles","style","schedulePositionUpdate","updateAllBadgePositions","scheduleScan","scanForImages","img","meta","removeBadgeAndWrapper","badge","wrapper","isExcludedDomain","hostname","normalized","domain","shouldSkipScanning","isHostBlocked","removeAllBadges","images","newImages","shouldTrackImage","attachBadge","rect","updateBadgeAria","badgeId","imgZIndex","parent","requestDetection","imageUrl","updateBadgeFromResponse","payload","sendDetectionRequest","response","error","resolve","label","existingCard","verdict","rateLimitLabel","hoverCard","createHoverCard","text","card","isAI","isSuccess","html","rawScore","scorePercent","rawConfidence","confidencePercent","errorMessage","escapeHtml","shortHash","div","count","updateDisabledHosts","items","host","normalizeHostname","value","disabledHostsSet","trimmed","candidate","syncSettings","enabled","init","observerTarget"],"mappings":"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"}